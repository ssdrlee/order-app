# 배포 체크리스트

## 사전 준비

### 코드 준비
- [ ] GitHub 저장소에 코드 푸시 완료
- [ ] `.env` 파일이 `.gitignore`에 포함되어 있는지 확인
- [ ] 민감한 정보(비밀번호, API 키 등)가 코드에 하드코딩되지 않았는지 확인

### 파일 확인
- [ ] `server/package.json`에 `start` 스크립트가 있는지 확인
- [ ] `ui/package.json`에 `build` 스크립트가 있는지 확인
- [ ] 이미지 파일이 `ui/public/images/` 폴더에 있는지 확인

---

## 1단계: PostgreSQL 데이터베이스 배포

### 데이터베이스 생성
- [ ] Render에서 PostgreSQL 데이터베이스 생성
- [ ] 데이터베이스 정보 확인 (호스트, 포트, 이름, 사용자, 비밀번호)
- [ ] 데이터베이스 연결 테스트

### 데이터베이스 초기화
- [ ] 로컬에서 External Database URL로 연결 테스트
- [ ] `npm run db:init` 실행하여 스키마 생성
- [ ] 초기 데이터 삽입 확인
- [ ] 이미지 경로 설정 확인

---

## 2단계: 백엔드 서버 배포

### 서비스 생성
- [ ] Render에서 Web Service 생성
- [ ] GitHub 저장소 연결
- [ ] Root Directory를 `server`로 설정
- [ ] Build Command: `npm install`
- [ ] Start Command: `npm start`

### 환경 변수 설정
- [ ] `NODE_ENV=production`
- [ ] `PORT=10000` (또는 Render가 자동 할당)
- [ ] `DB_HOST` (데이터베이스 호스트)
- [ ] `DB_PORT=5432`
- [ ] `DB_NAME` (데이터베이스 이름)
- [ ] `DB_USER` (사용자 이름)
- [ ] `DB_PASSWORD` (비밀번호)

### 배포 확인
- [ ] 배포 로그에서 오류 확인
- [ ] 서비스 URL 접속 테스트
- [ ] API 엔드포인트 테스트 (`/api/menus`)
- [ ] 데이터베이스 연결 확인

### 데이터베이스 초기화 (배포된 서버)
- [ ] Render Shell에서 데이터베이스 초기화 실행
- [ ] 또는 로컬에서 External URL로 초기화

---

## 3단계: 프런트엔드 배포

### 환경 변수 설정
- [ ] `VITE_API_URL` 설정 (백엔드 API URL)
- [ ] 예: `https://coffee-order-api.onrender.com/api`

### Static Site 생성
- [ ] Render에서 Static Site 생성
- [ ] GitHub 저장소 연결
- [ ] Root Directory를 `ui`로 설정
- [ ] Build Command: `npm install && npm run build`
- [ ] Publish Directory: `dist`

### 배포 확인
- [ ] 배포 로그에서 오류 확인
- [ ] 사이트 URL 접속 테스트
- [ ] 메뉴가 정상적으로 로드되는지 확인
- [ ] 이미지가 정상적으로 표시되는지 확인

---

## 4단계: 통합 테스트

### 기능 테스트
- [ ] 메뉴 목록 조회
- [ ] 주문 생성
- [ ] 관리자 화면 접속
- [ ] 주문 목록 조회
- [ ] 주문 상태 변경
- [ ] 재고 관리
- [ ] 대시보드 통계

### 오류 확인
- [ ] 브라우저 콘솔 오류 확인
- [ ] 네트워크 요청 오류 확인
- [ ] CORS 오류 확인
- [ ] API 응답 오류 확인

---

## 5단계: 최적화

### 성능 최적화
- [ ] 이미지 최적화 (필요시)
- [ ] 빌드 파일 크기 확인
- [ ] 로딩 시간 확인

### 보안 확인
- [ ] 환경 변수 노출 확인
- [ ] CORS 설정 확인
- [ ] 데이터베이스 비밀번호 보안 확인

---

## 문제 해결

### 자주 발생하는 문제

1. **데이터베이스 연결 오류**
   - 환경 변수 확인
   - Internal Database URL 사용
   - 방화벽 설정 확인

2. **빌드 오류**
   - Node.js 버전 확인
   - 의존성 설치 오류 확인
   - 빌드 로그 확인

3. **CORS 오류**
   - 백엔드 CORS 설정 확인
   - 프런트엔드 URL 확인

4. **이미지 로드 오류**
   - 이미지 파일 경로 확인
   - 빌드 후 이미지 파일 확인

---

## 배포 완료 후

- [ ] 모든 기능이 정상 작동하는지 확인
- [ ] 모니터링 설정 (필요시)
- [ ] 백업 설정 (필요시)
- [ ] 도메인 연결 (필요시)
- [ ] SSL 인증서 확인 (자동 적용됨)

---

## 유지보수

### 정기 점검
- [ ] 로그 확인
- [ ] 오류 모니터링
- [ ] 성능 모니터링
- [ ] 데이터베이스 백업

### 업데이트
- [ ] 코드 업데이트 시 자동 재배포 확인
- [ ] 데이터베이스 마이그레이션 (필요시)
- [ ] 환경 변수 업데이트 (필요시)

